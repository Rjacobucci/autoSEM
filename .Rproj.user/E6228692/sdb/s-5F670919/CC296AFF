{
    "contents" : "#'\n#'\n#' This function houses a number of different heuristic optimization algorithms for specification search.\n#' @param method which optimization algorithm to use\n#' @keywords autoSEM\n#' @export\n#' @examples\n#' autoSEM()\n#'\n#'\nautoSEM <- function(method=\"tabuSearch\",nfac=NULL,varNames=NULL,criterion=\"BIC\"){\n\n  fitness <- function(string) {\n    pt1 = string[1:6]\n    pt2 = string[7:12]\n    pt3 = string[13:18]\n\n    if(sum(pt1) < 3 | sum(pt2) < 3 | sum(pt3) < 3){\n\n      if(method==\"GA\"){\n        return(-99999999)\n      }else if(method=\"tabuSearch\"){\n        return(1)\n      }\n    }\n\n    inc1 <- which(pt1 == 1)\n    inc2 <- which(pt2 == 1)\n    inc3 <- which(pt3 == 1)\n\n    f1.vars <- c(\"x1\",\"x2\",\"x3\",\"x4\",\"x5\",\"x6\")\n    f2.vars <- c(\"x4\",\"x5\",\"x6\",\"x7\",\"x8\",\"x9\")\n    f3.vars <- c(\"x1\",\"x2\",\"x3\",\"x7\",\"x8\",\"x9\")\n\n    fmld <- c(paste(\"factor1 =~ \", paste(f1.vars[inc1], collapse= \"+\")),\n              paste(\"factor2 =~ \", paste(f2.vars[inc2], collapse= \"+\")),\n              paste(\"factor3 =~ \", paste(f3.vars[inc3], collapse= \"+\")))\n\n\n    #vars = unique(c(f1.vars[inc1],f2.vars[inc2],f3.vars[inc3]))\n    #cov.test = cov(myData.test[vars])\n\n\n    out = lavaan::cfa(fmld,myData,orthogonal=T,std.lv=T)\n\n    if(inspect(out,\"converged\")==F | any(eigen(inspect(out,\"cov.lv\"))$values < 0)){\n\n      if(method==\"GA\"){\n        return(-99999999)\n      }else if(method=\"tabuSearch\"){\n        return(1)\n      }\n\n    }else{\n      bic = fitMeasures(out)[\"bic\"]\n      df=out@Fit@test[[1]]$df\n      cov.order = out@Data@ov.names\n      cov.test = cov(myData.test[,unlist(cov.order)])\n      impcov = fitted(out)$cov\n      fit.test = 0.5*(log(det(impcov)) + trace(cov.test %*% solve(impcov)) - log(det(cov.test))  - 9)\n      chisq.test = N*fit.test\n      ncp.test = d(chisq.test,df,N)\n      RMSEA.test = rmsea(ncp.test,df)\n\n      if(criterion==\"BIC\"){\n        return_val = -bic\n      }else if(criterion==\"RMSEA\"){\n        return_val= -RMSEA.test\n      }\n\n\n      if(method==\"GA\"){\n        return(return_val + 1000000000000)\n      }else if(method=\"tabuSearch\"){\n        return(return_val + 1000000000000)\n      }\n\n    }\n  }\n\n\n  if(method==\"GA\"){\n    out = ga(\"binary\", fitness = fitness, nBits = p_length,monitor=T)\n  }else if(method=\"tabuSearch\"){\n    out = tabuSearch(size = p_length, iters = 50,objFunc = fitness)\n  }\n\n  out\n}\n",
    "created" : 1442967905607.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1715381571",
    "id" : "CC296AFF",
    "lastKnownWriteTime" : 1442968808,
    "path" : "~/Documents/Github/autoSEM/R/autoSEM.R",
    "project_path" : "R/autoSEM.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}