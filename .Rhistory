fitMeasures(out)["bic"]
N=500
population.model <- '
f1 =~ 1*x1 + 0.2*x2 + 1*x3
f2 =~ 1*x4 + 0.2*x5 + 1*x6
f3 =~ 1*x7 + 0.2*x8 + 1*x9
f1~~1*f1
f2~~1*f2
f3~~1*f3
f1~~0*f2
f2~~0*f3
f1~~0*f3
'
myData <- simulateData(population.model, sample.nobs=N)
myData.test <- simulateData(population.model, sample.nobs=N)
fa <-'
f1 =~ 1*x1 + x2 + x3 + x4 + x5 + x6
f2 =~ 1*x4 + x5 + x6 + x7 + x8 + x9
f3 =~ NA*x1 + x2 + x3 + 1*x7 + x8 + x9
f1~~1*f1
f2~~1*f2
f3~~1*f3
f1~~0*f2
f2~~0*f3
f1~~0*f3
'
sim.out = cfa(fa,myData)
library(GA)
fitMeasures(sim.out)
library(lavaan)
fitMeasures(sim.out)
N=500
population.model <- '
f1 =~ 1*x1 + 0.2*x2 + 1*x3
f2 =~ 1*x4 + 0.2*x5 + 1*x6
f3 =~ 1*x7 + 0.2*x8 + 1*x9
f1~~1*f1
f2~~1*f2
f3~~1*f3
f1~~0*f2
f2~~0*f3
f1~~0*f3
'
myData <- simulateData(population.model, sample.nobs=N)
myData.test <- simulateData(population.model, sample.nobs=N)
fa <-'
f1 =~ 1*x1 + x2 + x3 + x4 + x5 + x6
f2 =~ 1*x4 + x5 + x6 + x7 + x8 + x9
f3 =~ NA*x1 + x2 + x3 + 1*x7 + x8 + x9
f1~~1*f1
f2~~1*f2
f3~~1*f3
f1~~0*f2
f2~~0*f3
f1~~0*f3
'
sim.out = cfa(fa,myData)
library(GA)
fitMeasures(sim.out)
library(lavaan)
library(devtools)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
library(lavaan)
library(devtools)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
library(lavaan)
library(devtools)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
install("autoSEM")
detach("package:autoSEM", unload=TRUE)
library(autoSEM)
lll = list(f1.vars,f2.vars,f3.vars)
f1.vars <- c("x1","x2","x3","x4","x5","x6")
f2.vars <- c("x4","x5","x6","x7","x8","x9")
f3.vars <- c("x1","x2","x3","x7","x8","x9")
lll = list(f1.vars,f2.vars,f3.vars)
lll
nlevels(lll)
levels(lll)
library(lavaan)
N=500
population.model <- '
f1 =~ 1*x1 + 0.2*x2 + 1*x3
f2 =~ 1*x4 + 0.2*x5 + 1*x6
f3 =~ 1*x7 + 0.2*x8 + 1*x9
f1~~1*f1
f2~~1*f2
f3~~1*f3
f1~~0*f2
f2~~0*f3
f1~~0*f3
'
myData <- simulateData(population.model, sample.nobs=N)
myData.test <- simulateData(population.model, sample.nobs=N)
fa <-'
f1 =~ 1*x1 + x2 + x3 + x4 + x5 + x6
f2 =~ 1*x4 + x5 + x6 + x7 + x8 + x9
f3 =~ NA*x1 + x2 + x3 + 1*x7 + x8 + x9
f1~~1*f1
f2~~1*f2
f3~~1*f3
f1~~0*f2
f2~~0*f3
f1~~0*f3
'
sim.out = cfa(fa,myData)
nfac=3
lll
ooo = list()
i
i=1
i
paste("f",i)
paste("f",i,sep="")
paste("paste("f",i,sep="") =~ ", paste(lll[[i]], collapse= "+"))
facc = paste("f",i,sep="")
facc = paste("f",i,sep="")
facc
paste(paste(facc," =~ "), paste(lll[[i]], collapse= "+"))
ooo = list()
for(i in 1:nfac){
facc = paste("f",i,sep="")
ooo[[i]] = paste(paste(facc," =~ "), paste(lll[[i]], collapse= "+"))
}
ooo
unlist(ooo)
?grep
grep(" ",unlist(ooo),",")
grepl(" ",unlist(ooo),",")
grep(" ",",",unlist(ooo))
grep(" "," ",unlist(ooo))
grep(","," ",unlist(ooo))
grep("  "," ",unlist(ooo))
grep(1," ",unlist(ooo))
grep("1"," ",unlist(ooo))
grep(," ",unlist(ooo),fixed=T)
grep(" ",",",unlist(ooo),fixed=T)
fa
grep(" ",\n,unlist(ooo))
grep(" ","\n",unlist(ooo))
unlist(ooo)
grep(//" ","\n",unlist(ooo))
install.packages("stringr")
library(stringr)
?str_replace
str_replace(unlist(ooo)," \\(.*\\)", "")
str_replace(unlist(ooo)," \\ \\", "")
fmld <- string()
fmld <- NA
fmld <- NA
for(jj in 1:nfac){
fmld <- paste(fmld,ooo[[jj]])
}
fmld
fmld <- ""
for(jj in 1:nfac){
fmld <- paste(fmld,ooo[[jj]],sep="/n")
}
fmld
start = c(1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1)
f1.vars[start[1:6]]
start = c(1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1)
lll = list(f1.vars,f2.vars,f3.vars)
ooo = list()
lll
length(lll[[1]])
yyy = list()
ll
lll
length(lll)
uuu = list)
for(i in 1:length(lll)){
uuu[[i]] = length(lll[[i]])
}
uuu = list()
for(i in 1:length(lll)){
uuu[[i]] = length(lll[[i]])
}
uuu
uuu[[0]]
klkj;sdaflk;jklj;sdff;lk;jklljk;jk;fsd;ljkfdsa;ljk;sd
lkjjkljkldsjklfdsljk;fdsjlkdfskljldsjklfsdjklfdsfljk;jkl;jkljlk;jl;kjkl;;ljkfasl;jkjfdsljk;fdsjlk;fsdjkl;adfsjl;kfsda;ljkdsfaj;lklsdf;jlkksdfjlk;sdfl;jksdfajl;k;ljkfdsal;jkdfsljk;afds;jlkafdsjl;kdsf;ljkasfdjkl;l;jkjkl;l;jkfdsj;lkfsdajkl;adfsf;jklfdsa;jkldfsa
lll[i]
yyy[[i]] = lll[i][start[1:uuu[ind]]]
seq(3,0)
uuu
start
uuu
jjj =  list()
start[-start[1:uuu[i]]]]
start[-start[1:uuu[i]]]
i
start[-start[1:uuu[[i]]]
start[1:uuu[[i]]]
start[-start[1:uuu[[i]]]]
start[1:uuu[[i]]]
start[-1:uuu[[i]]]
uuu[[i]]
start[-(1:uuu[[i]])]
jjj =  list()
for(i in 1:nfac){
jjj[[i]] =  start[1:uuu[i]]
start = start[-(1:uuu[[i]])]
}
jjj =  list()
for(i in 1:nfac){
jjj[[i]] =  start[1:uuu[[i]]]
start = start[-(1:uuu[[i]])]
}
jjj
lll[[1]]
lll[[1]]jjj[[1]]
lll[[1]][jjj[[1]]]
lll[[1]][jjj[[1]]==1]
jjj
library(lavaan)
library(devtools)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
install("autoSEM")
#document()
#document("C:/Users/jacobucc/Documents/GitHub/regsem")
detach("package:autoSEM", unload=TRUE)
library(autoSEM)
rrr = list(f1.vars,f2.vars,f3.vars)
autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3)
library(tabuSearch)
library(GA)
autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3)
rrr
unique(rrr)
unique(unlist(rrr))
length(unique(rrr))
length(unique(unlist(rrr)))
rrr
length(unlist(rr))
length(unlist(rrr))
library(lavaan)
library(devtools)
library(tabuSearch)
library(GA)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
install("autoSEM")
#document()
#document("C:/Users/jacobucc/Documents/GitHub/regsem")
detach("package:autoSEM", unload=TRUE)
library(autoSEM)
autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3)
fmld
fa
method="tabuSearch"
nfac=3
varList=rrr
criterion="BIC"
minInd=3
fitness <- function(string) {
lll = varList
uuu = list()
for(i in 1:length(lll)){
uuu[[i]] = length(lll[[i]])
}
jjj =  list()
for(i in 1:nfac){
jjj[[i]] =  string[1:uuu[[i]]]
string = string[-(1:uuu[[i]])]
}
for(i in 1:length(jjj)){
if(sum(jjj[[i]]) < minInd){
if(method=="GA"){
return(-99999999)
}else if(method=="tabuSearch"){
return(1)
}
}
}
ooo = list()
for(i in 1:nfac){
facc = paste("f",i,sep="")
ooo[[i]] = paste(paste(facc," =~ "), paste(lll[[i]][jjj[[i]]==1], collapse= "+"))
}
fmld <- ""
for(jj in 1:nfac){
fmld <- paste(fmld,ooo[[jj]],sep="/n")
}
p = length(unique(unlist(varList)))
out = lavaan::cfa(fmld,myData,orthogonal=T,std.lv=T)
if(inspect(out,"converged")==F | any(eigen(inspect(out,"cov.lv"))$values < 0)){
if(method=="GA"){
return(-99999999)
}else if(method=="tabuSearch"){
return(1)
}
}else{
bic = fitMeasures(out)["bic"]
df=out@Fit@test[[1]]$df
cov.order = out@Data@ov.names
cov.test = cov(myData.test[,unlist(cov.order)])
impcov = fitted(out)$cov
fit.test = 0.5*(log(det(impcov)) + trace(cov.test %*% solve(impcov)) - log(det(cov.test))  - p)
chisq.test = N*fit.test
ncp.test = d(chisq.test,df,N)
RMSEA.test = rmsea(ncp.test,df)
if(criterion=="BIC"){
return_val = -bic
}else if(criterion=="RMSEA"){
return_val= -RMSEA.test
}
if(method=="GA"){
return(return_val + 1000000000000)
}else if(method=="tabuSearch"){
return(return_val + 1000000000000)
}
}
}
p_length = length(unlist(varList))
if(method=="GA"){
out = ga("binary", fitness = fitness, nBits = p_length,monitor=T)
}else if(method=="tabuSearch"){
out = tabuSearch(size = p_length, iters = 50,objFunc = fitness)
}
out
lll = varList
uuu = list()
for(i in 1:length(lll)){
uuu[[i]] = length(lll[[i]])
}
jjj =  list()
for(i in 1:nfac){
jjj[[i]] =  string[1:uuu[[i]]]
string = string[-(1:uuu[[i]])]
}
for(i in 1:length(jjj)){
if(sum(jjj[[i]]) < minInd){
if(method=="GA"){
return(-99999999)
}else if(method=="tabuSearch"){
return(1)
}
}
}
ooo = list()
for(i in 1:nfac){
facc = paste("f",i,sep="")
ooo[[i]] = paste(paste(facc," =~ "), paste(lll[[i]][jjj[[i]]==1], collapse= "+"))
}
start
start = c(1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1)
string=start
lll = varList
uuu = list()
for(i in 1:length(lll)){
uuu[[i]] = length(lll[[i]])
}
jjj =  list()
for(i in 1:nfac){
jjj[[i]] =  string[1:uuu[[i]]]
string = string[-(1:uuu[[i]])]
}
for(i in 1:length(jjj)){
if(sum(jjj[[i]]) < minInd){
if(method=="GA"){
return(-99999999)
}else if(method=="tabuSearch"){
return(1)
}
}
}
ooo = list()
for(i in 1:nfac){
facc = paste("f",i,sep="")
ooo[[i]] = paste(paste(facc," =~ "), paste(lll[[i]][jjj[[i]]==1], collapse= "+"))
}
fmld <- ""
for(jj in 1:nfac){
fmld <- paste(fmld,ooo[[jj]],sep="/n")
}
p = length(unique(unlist(varList)))
out = lavaan::cfa(fmld,myData,orthogonal=T,std.lv=T)
fmld
fmld <- ""
for(jj in 1:nfac){
fmld <- paste(fmld,ooo[[jj]],sep="\n")
}
p = length(unique(unlist(varList)))
out = lavaan::cfa(fmld,myData,orthogonal=T,std.lv=T)
library(lavaan)
library(devtools)
library(tabuSearch)
library(GA)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
install("autoSEM")
#document()
#document("C:/Users/jacobucc/Documents/GitHub/regsem")
detach("package:autoSEM", unload=TRUE)
library(autoSEM)
autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3)
out
library(lavaan)
library(devtools)
library(tabuSearch)
library(GA)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
install("autoSEM")
#document()
#document("C:/Users/jacobucc/Documents/GitHub/regsem")
detach("package:autoSEM", unload=TRUE)
library(autoSEM)
autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3)
autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3,niter=5)
library(lavaan)
library(devtools)
library(tabuSearch)
library(GA)
setwd("/Users/RJacobucci/Documents/Github/autoSEM")
#setwd("C:/Users/jacobucc/Documents/Github/autoSEM")
#setwd("./regsem")
document()
setwd("..")
install("autoSEM")
#document()
#document("C:/Users/jacobucc/Documents/GitHub/regsem")
detach("package:autoSEM", unload=TRUE)
library(autoSEM)
autoSEM(method="GA",nfac=3,varList=rrr,criterion="BIC",minInd=3,niter=5)
ret = autoSEM(method="GA",nfac=3,varList=rrr,criterion="BIC",minInd=3,niter=5)
ret
summary(ret)
ret = autoSEM(method="GA",nfac=3,varList=rrr,criterion="BIC",minInd=3,niter=15)
summary(ret)
ret = autoSEM(method="tabuSearch",nfac=3,varList=rrr,criterion="BIC",minInd=3,niter=5)
summary(ret)
ret
